	TSTO #23
	BOV pile_pleine
	ADDSP #1000
; table des methodes
; construction de la table des methodes de Object
	LOAD #null, R0
	STORE R0, 1(GB)
	LOAD code.Object.equals, R0
	STORE R0, 2(GB)
; construction de la table des methodes de fct
	LEA 1(GB), R0
	STORE R0, 3(GB)
	LOAD code.fct.fact, R0
	STORE R0, 5(GB)
	LOAD code.fct.fibo, R0
	STORE R0, 6(GB)
	LOAD code.Object.equals, R0
	STORE R0, 4(GB)
; Main program
; Beginning of main instructions:
; instruction new
	NEW #1, R2
	LEA 3(GB), R0
	STORE R0, 0(R2)
	PUSH R2
	BSR init.fct
	POP R2
	STORE R2, 7(GB)
	LOAD #6, R2
	STORE R2, 8(GB)
; appel de methode2
	ADDSP #2
	LOAD 7(GB), R2
	STORE R2, 0(SP)
	LOAD 8(GB), R3
	STORE R3, -1(SP)
	LOAD 0(SP), R2
	CMP #null, R2
	BEQ pile_pleine
	LOAD 0(R2), R2
	BSR 2(R2)
	SUBSP #2
	LOAD R0, R3
	STORE R3, 9(GB)
; appel de methode3
	ADDSP #2
	LOAD 7(GB), R3
	STORE R3, 0(SP)
	LOAD 8(GB), R2
	STORE R2, -1(SP)
	LOAD 0(SP), R3
	CMP #null, R3
	BEQ pile_pleine
	LOAD 0(R3), R3
	BSR 3(R3)
	SUBSP #2
	LOAD R0, R2
	STORE R2, 10(GB)
	LOAD 9(GB), R1
	WINT
	WSTR " "
	LOAD 10(GB), R1
	WINT
	WNL
	HALT
init.fct:
	RTS
code.fct.fact:
	PUSH R6
	PUSH R5
	PUSH R4
	PUSH R3
	PUSH R2
	LOAD -3(LB), R3
	LOAD #0, R4
	SUB R4, R3
	LOAD R3, R1
	BEQ OpCmp_if_in_a411
	LOAD #1, R1
	BRA OpCmp_fin_in_a411
OpCmp_if_in_a411:
	LOAD #0, R1
OpCmp_fin_in_a411:
	LOAD R1, R2
	LOAD R2, R1
	BNE IfThenElse_else_a411
	LOAD #1, R4
	LOAD R4, R0
	BRA IfThenElse_fin_a411
IfThenElse_else_a411:
	LOAD -3(LB), R4
; appel de methode2
	ADDSP #2
	LOAD -2(LB), R3
	STORE R3, 0(SP)
	LOAD -3(LB), R5
	LOAD #1, R6
	SUB R6, R5
	STORE R5, -1(SP)
	LOAD 0(SP), R3
	CMP #null, R3
	BEQ pile_pleine
	LOAD 0(R3), R3
	BSR 2(R3)
	SUBSP #2
	LOAD R0, R5
	MUL R5, R4
	BOV over_flow
	LOAD R4, R0
IfThenElse_fin_a411:
	POP R2
	POP R3
	POP R4
	POP R5
	POP R6
	RTS
code.fct.fibo:
	PUSH R7
	PUSH R6
	PUSH R5
	PUSH R4
	PUSH R3
	PUSH R2
	LOAD -3(LB), R4
	LOAD #0, R5
	SUB R5, R4
	LOAD R4, R1
	BEQ OpCmp_if_in_a1411
	LOAD #1, R1
	BRA OpCmp_fin_in_a1411
OpCmp_if_in_a1411:
	LOAD #0, R1
OpCmp_fin_in_a1411:
	LOAD R1, R2
	LOAD R2, R1
	BNE IfThenElse_else_a1411
	LOAD #0, R5
	LOAD R5, R0
	BRA IfThenElse_fin_a1411
IfThenElse_else_a1411:
	LOAD -3(LB), R4
	LOAD #1, R3
	SUB R3, R4
	LOAD R4, R1
	BEQ OpCmp_if_in_a1716
	LOAD #1, R1
	BRA OpCmp_fin_in_a1716
OpCmp_if_in_a1716:
	LOAD #0, R1
OpCmp_fin_in_a1716:
	LOAD R1, R5
	LOAD R5, R1
	BNE IfThenElse_else_a1716
	LOAD #1, R3
	LOAD R3, R0
	BRA IfThenElse_fin_a1716
IfThenElse_else_a1716:
; appel de methode3
	ADDSP #2
	LOAD -2(LB), R3
	STORE R3, 0(SP)
	LOAD -3(LB), R4
	LOAD #1, R6
	SUB R6, R4
	STORE R4, -1(SP)
	LOAD 0(SP), R3
	CMP #null, R3
	BEQ pile_pleine
	LOAD 0(R3), R3
	BSR 3(R3)
	SUBSP #2
	LOAD R0, R4
; appel de methode3
	ADDSP #2
	LOAD -2(LB), R3
	STORE R3, 0(SP)
	LOAD -3(LB), R6
	LOAD #2, R7
	SUB R7, R6
	STORE R6, -1(SP)
	LOAD 0(SP), R3
	CMP #null, R3
	BEQ pile_pleine
	LOAD 0(R3), R3
	BSR 3(R3)
	SUBSP #2
	LOAD R0, R6
	ADD R6, R4
	LOAD R4, R0
IfThenElse_fin_a1716:
IfThenElse_fin_a1411:
	POP R2
	POP R3
	POP R4
	POP R5
	POP R6
	POP R7
	RTS
code.Object.equals:
pile_pleine:
	WSTR "Error: Stack Overflow"
	WNL
	ERROR
over_flow:
	WSTR "Error: Overflow during arithmetic operation"
	WNL
	ERROR
i0_error:
	WSTR "Error: Input/Output error"
	WNL
	ERROR
divisionErr:
	WSTR "Error :Division par 0"
	WNL
	ERROR
